@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&display=swap');

/*
  Flow Light — 一款护眼、优雅、简洁的 Typora 浅色主题
  设计原则：柔和对比、低饱和点缀色、充足留白与清晰的层次
*/

:root {
  /* 基础色：柔和浅灰白背景 + 深灰正文 */
  --bg-color: #FAFAFA;
  --side-bar-bg-color: #F5F6F8;
  --text-color: #2B2F36;

  /* 选区与交互 */
  --select-text-bg-color: #CDE6FE;
  --selection-text-color: #0E1A2B;
  --item-hover-bg-color: #EEF2F7;
  --control-text-color: #5F6B7A;
  --control-text-hover-color: #1F2937;
  --border-color: #D6DCE5;
  --window-border: 1px solid #D6DCE5;

  /* 文件与高亮 */
  --active-file-bg-color: #E9EFFA;
  --active-file-border-color: #8CB7FF;
  --active-file-text-color: #1F2937;
  --item-hover-text-color: #1F2937;

  /* 代码与面板 */
  --rawblock-edit-panel-bd: #EDF2F7;
  --code-bg-color: #F5F7FA;
  --code-border-color: #E6EAF0;

  /* 代码 token 颜色（护眼、简洁、低饱和） */
  --code-token-comment: #6F7D8C;     /* 柔和灰，用于注释/提示 */
  --code-token-keyword: #2B5DB0;     /* 低饱和蓝，突出但不刺眼 */
  --code-token-type: #2B5DB0;        /* 类型与关键字同色，减少色彩数量 */
  --code-token-string: #2B6A4A;       /* 低饱和绿，表示字符串 */
  --code-token-number: #8A5A3C;       /* 暖棕色，数字与常量 */
  --code-token-function: #2A5AA8;     /* 函数/方法，略深的蓝 */
  --code-token-variable: #3E546B;     /* 变量/参数，蓝灰中性 */
  --code-token-attribute: #4A6F8A;    /* 属性/限定符，蓝灰 */
  --code-token-tag: #2B5DB0;          /* 标签/名称，保持统一的蓝色 */
  --code-token-builtin: #2A5AA8;      /* 内置/特殊标识 */
  --code-token-property: #2F506B;     /* 对象属性，更稳重的蓝灰 */
  --code-token-operator: #364151;     /* 运算符/标点，接近正文色 */
  --code-token-punctuation: var(--text-color);

  /* 链接与强调 */
  --primary-color: #3778C2;
  --accent-color: #BFD8FF;
  --link-color: #1E66D6;
  --link-hover-color: #125BD3;

  /* 键盘标记 */
  --kbd-bg-color: #EDEFF2;
  --kbd-text-color: #2B2F36;
}

html {
  font-size: 16px;
  -webkit-font-smoothing: antialiased;
}

html,
body {
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
  background: var(--bg-color);
  fill: currentColor;
  line-height: 1.72rem;
}

#write {
  max-width: 914px;
}

@media only screen and (min-width: 1400px) {
  #write { max-width: 1024px; }
}

@media only screen and (min-width: 1800px) {
  #write { max-width: 1200px; }
}

html,
body,
button,
input,
select,
textarea,
div.code-tooltip-content {
  color: var(--text-color);
  border-color: transparent;
}

div.code-tooltip,
.md-hover-tip .md-arrow:after { background: var(--code-bg-color); }

.native-window #md-notification { border: 1px solid var(--border-color); }

.popover.bottom > .arrow:after { border-bottom-color: var(--code-bg-color); }

html,
body,
button,
input,
select,
textarea {
  font-family: 'Helvetica Neue', Helvetica, Arial, 'Segoe UI Emoji', sans-serif;
}

hr {
  height: 2px;
  border: 0;
  margin: 24px 0 !important;
}

h1,
h2,
h3,
h4,
h5,
h6 {
  font-family: 'Lucida Grande', 'Corbel', sans-serif;
  font-weight: normal;
  clear: both;
  -ms-word-wrap: break-word;
  word-wrap: break-word;
  margin: 0;
  padding: 0;
  color: #1F2937;
}

h1 { font-size: 2.5rem; line-height: 2.75rem; margin-bottom: 1.5rem; letter-spacing: -1.5px; }
h2 { font-size: 1.63rem; line-height: 1.875rem; margin-bottom: 1.5rem; letter-spacing: -1px; font-weight: bold; }
h3 { font-size: 1.17rem; line-height: 1.5rem; margin-bottom: 1.5rem; letter-spacing: -1px; font-weight: bold; }
h4 { font-size: 1.12rem; line-height: 1.375rem; margin-bottom: 1.5rem; color: #1F2937; }
h5 { font-size: 0.97rem; line-height: 1.25rem; margin-bottom: 1.5rem; font-weight: bold; }
h6 { font-size: 0.93rem; line-height: 1rem; margin-bottom: 0.75rem; color: #1F2937; }

@media (min-width: 980px) {
  h3.md-focus:before,
  h4.md-focus:before,
  h5.md-focus:before,
  h6.md-focus:before {
    color: #9AA2AF;
    border: 1px solid #D6DCE5;
    border-radius: 3px;
    position: absolute;
    left: -1.642857143rem;
    top: 0.357142857rem;
    float: left;
    font-size: 9px;
    padding-left: 2px;
    padding-right: 2px;
    vertical-align: bottom;
    font-weight: normal;
    line-height: normal;
    background: #FFFFFF;
  }
  h3.md-focus:before { content: 'h3'; }
  h4.md-focus:before { content: 'h4'; }
  h5.md-focus:before { content: 'h5'; top: 0px; }
  h6.md-focus:before { content: 'h6'; top: 0px; }
}

a { text-decoration: none; outline: 0; }
a:hover { outline: 0; }
a:focus { outline: thin dotted; }

sup.md-footnote { background-color: #E9EEF6; color: #2B2F36; }

p { -ms-word-wrap: break-word; word-wrap: break-word; }

p,
ul,
dd,
ol,
hr,
address,
pre,
table,
iframe,
.wp-caption,
.wp-audio-shortcode,
.wp-video-shortcode { margin-top: 0; margin-bottom: 1.5rem; }

audio:not([controls]) { display: none; }

[hidden] { display: none; }

::-moz-selection { background: var(--select-text-bg-color); color: var(--selection-text-color); text-shadow: none; }
*.in-text-selection,
::selection { background: var(--select-text-bg-color); color: var(--selection-text-color); text-shadow: none; }

ul, ol { padding: 0 0 0 1.875rem; }
ul { list-style: square; }
ol { list-style: decimal; }
ul ul, ol ol, ul ol, ol ul { margin: 0; }

b, th, dt, strong { font-weight: bold; }
i, em, dfn, cite { font-style: italic; }

blockquote {
  padding-left: 1.875rem;
  margin: 0 0 1.875rem 1.875rem;
  border-left: solid 2px var(--border-color);
  padding-left: 30px;
  margin-top: 35px;
  color: #6B7280;
}

pre,
code,
kbd,
tt,
var {
  font-size: 0.875em;
  font-family: 'JetBrains Mono', Monaco, Consolas, 'Andale Mono', 'DejaVu Sans Mono', monospace;
}

code,
tt,
var { background: rgba(0, 0, 0, 0.06); }

kbd {
  padding: 2px 4px;
  font-size: 90%;
  color: var(--kbd-text-color);
  background-color: var(--kbd-bg-color);
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.08);
}

pre.md-fences {
  padding: 10px 10px 10px 30px;
  margin-bottom: 20px;
  background: var(--code-bg-color);
  border: 1px solid var(--code-border-color);
  border-radius: 6px;
}

.CodeMirror-gutters { background: var(--code-bg-color); border-right: 1px solid var(--code-border-color); }

.enable-diagrams pre.md-fences[lang='sequence'] .code-tooltip,
.enable-diagrams pre.md-fences[lang='flow'] .code-tooltip,
.enable-diagrams pre.md-fences[lang='mermaid'] .code-tooltip { bottom: -2.2em; right: 4px; }

code, kbd, tt, var { padding: 2px 5px; }

table { max-width: 100%; width: 100%; border-collapse: collapse; border-spacing: 0; }
th, td { padding: 5px 10px; vertical-align: top; }

a { -webkit-transition: all 0.2s ease-in-out; transition: all 0.2s ease-in-out; }

hr { background: var(--border-color); }
h1 { margin-top: 2em; }

a { color: var(--link-color); text-decoration: underline; }
a:hover { color: var(--link-hover-color); }

.md-inline-math script { color: #4F7DB6; }

b, th, dt, strong { color: #1F2937; }

mark { background: #FFF4B1; }

table a { color: var(--link-color); }
th, td { border: solid 1px var(--border-color); }

.task-list { padding-left: 0; }
.md-task-list-item { padding-left: 1.25rem; }
.md-task-list-item > input { top: auto; }
.md-task-list-item > input:before {
  content: '';
  display: inline-block;
  width: 0.875rem;
  height: 0.875rem;
  vertical-align: middle;
  text-align: center;
  border: 1px solid var(--text-color);
  background-color: var(--bg-color);
  margin-top: -0.4rem;
}
.md-task-list-item > input:checked:before,
.md-task-list-item > input[checked]:before {
  content: '\221A';
  font-size: 0.625rem;
  line-height: 0.625rem;
  color: var(--text-color);
}

/** quick open **/
.auto-suggest-container { border: 0px; background-color: #F0F3F7; }
#typora-quick-open { background-color: #F0F3F7; }
#typora-quick-open input { background-color: #FFFFFF; border: 0; border-bottom: 1px solid var(--border-color); }
.typora-quick-open-item { background-color: inherit; color: inherit; }
.typora-quick-open-item.active,
.typora-quick-open-item:hover { background-color: #E9EFFA; color: #1F2937; }
.typora-quick-open-item:hover { background-color: rgba(233, 239, 250, 0.8); }
.typora-search-spinner > div { background-color: #333; }

#write pre.md-meta-block { border-bottom: 1px dashed #CCD6E0; background: transparent; padding-bottom: 0.6em; line-height: 1.6em; }

.btn, .btn .btn-default { background: transparent; color: #475569; }

.ty-table-edit { border-top: 1px solid var(--border-color); background-color: var(--bg-color); }
.popover-title { background: transparent; }

.md-image > .md-meta { color: #9AA0A6; background: transparent; }
.md-expand.md-image > .md-meta { color: var(--text-color); }

#write > h3:before,
#write > h4:before,
#write > h5:before,
#write > h6:before {
  border: none;
  border-radius: 0px;
  color: #9AA2AF;
  text-decoration: underline;
  left: -1.4rem;
  top: 0.2rem;
}
#write > h3.md-focus:before { top: 2px; }
#write > h4.md-focus:before { top: 2px; }

.md-toc-item { color: #607D9E; }
#write div.md-toc-tooltip { background-color: #F0F3F7; }

.dropdown-menu .btn:hover,
.dropdown-menu .btn:focus,
.md-toc .btn:hover,
.md-toc .btn:focus { color: #0F172A; background: #E9EFFA; }

#toc-dropmenu { background: #FFFFFF; border: 1px solid var(--border-color); }
#toc-dropmenu .divider { background-color: #D6DCE5; }

.outline-expander:before { top: 2px; }

#typora-sidebar { box-shadow: none; border-right: none; }
.sidebar-tabs { border-bottom: 0; }
#typora-sidebar:hover .outline-title-wrapper { border-left: 1px dashed var(--border-color); }
.outline-title-wrapper .btn { color: inherit; }
.outline-item:hover { border-color: var(--bg-color); background-color: var(--item-hover-bg-color); color: var(--item-hover-text-color); }

h1.md-focus .md-attr,
h2.md-focus .md-attr,
h3.md-focus .md-attr,
h4.md-focus .md-attr,
h5.md-focus .md-attr,
h6.md-focus .md-attr,
.md-header-span .md-attr { color: #8C8E92; display: inline; }

.md-comment { color: #3778C2; opacity: 0.8; }
.md-inline-math svg { color: var(--text-color); }

#math-inline-preview .md-arrow:after { background: #FFFFFF; }

.modal-content { background: var(--bg-color); border: 0; }
.modal-title { font-size: 1.5em; }
.modal-content input { background-color: #FFFFFF; color: var(--text-color); }
.modal-content .input-group-addon { color: var(--text-color); }
.modal-backdrop { background-color: rgba(174, 174, 174, 0.7); }
.modal-content .btn-primary { border-color: var(--primary-color); }
.md-table-resize-popover { background-color: var(--code-bg-color); }
.form-inline .input-group .input-group-addon { color: var(--active-file-text-color); }
#md-searchpanel { border-bottom: 1px dashed var(--border-color); }

/** UI for electron */
.context-menu,
#spell-check-panel,
#footer-word-count-info { background-color: #FFFFFF; }
.context-menu.dropdown-menu .divider,
.dropdown-menu .divider { background-color: #D6DCE5; opacity: 1; }

footer { color: inherit; }
@media (max-width: 1000px) {
  footer { border-top: none; }
  footer:hover { color: inherit; }
}

#file-info-file-path .file-info-field-value:hover { background-color: #E9EFFA; color: var(--item-hover-text-color); }

.megamenu-content,
.megamenu-opened header { background: var(--bg-color); }
.megamenu-menu-panel h2,
.megamenu-menu-panel h1,
.long-btn { color: inherit; }
.megamenu-menu-panel input[type='text'] { background: inherit; border: 0; border-bottom: 1px solid var(--border-color); }
#recent-file-panel-action-btn { background: inherit; border: 1px solid var(--border-color); }
.megamenu-menu-panel .dropdown-menu > li > a { color: inherit; background-color: #F5F7FA; text-decoration: none; }
.megamenu-menu-panel table td:nth-child(1) { color: inherit; font-weight: bold; }
.megamenu-menu-panel tbody tr:hover td:nth-child(1) { color: #1F2937; }
.modal-footer .btn-default,
.modal-footer .btn-primary,
.modal-footer .btn-default:not(:hover) { border: 1px solid; border-color: transparent; }
.btn-primary { color: #FFFFFF; background-color: var(--primary-color); border-color: var(--primary-color); }
.btn-default:hover,
.btn-default:focus,
.btn-default.focus,
.btn-default:active,
.btn-default.active,
.open > .dropdown-toggle.btn-default { color: #0F172A; border: 1px solid var(--border-color); background-color: #FFFFFF; }
.modal-header { border-bottom: 0; }
.modal-footer { border-top: 0; }
#recent-file-panel tbody tr:nth-child(2n-1) { background-color: transparent !important; }
.megamenu-menu-panel tbody tr:hover td:nth-child(2) { color: inherit; }
.megamenu-menu-panel .btn { border: 1px solid #EEE; background: transparent; }
.mouse-hover .toolbar-icon.btn:hover,
#w-full.mouse-hover,
#w-pin.mouse-hover { background-color: inherit; }

.typora-node::-webkit-scrollbar { width: 5px; }
.typora-node::-webkit-scrollbar-thumb:vertical { background: rgba(0, 0, 0, 0.15); }
.typora-node::-webkit-scrollbar-thumb:vertical:active { background: rgba(0, 0, 0, 0.25); }

#w-unpin { background-color: #4182c4; }
#top-titlebar,
#top-titlebar * { color: var(--item-hover-text-color); }
.typora-sourceview-on #toggle-sourceview-btn,
#footer-word-count:hover,
.ty-show-word-count #footer-word-count { background: #EAEAEA; }
#toggle-sourceview-btn:hover { color: #1F2937; background: #EAEAEA; }

/** focus mode */
.on-focus-mode .md-end-block:not(.md-focus):not(.md-focus-container) * { color: #9AA0A6 !important; }
.on-focus-mode .md-end-block:not(.md-focus) img,
.on-focus-mode .md-task-list-item:not(.md-focus-container) > input { opacity: 0.6 !important; }
.on-focus-mode li[cid]:not(.md-focus-container) { color: #9AA0A6; }
.on-focus-mode .md-fences.md-focus .CodeMirror-code > *:not(.CodeMirror-activeline) *,
.on-focus-mode .CodeMirror.cm-s-inner:not(.CodeMirror-focused) * { color: #9AA0A6 !important; }
.on-focus-mode .md-focus,
.on-focus-mode .md-focus-container { color: #0F172A; }
.on-focus-mode #typora-source .CodeMirror-code > *:not(.CodeMirror-activeline) * { color: #9AA0A6 !important; }

/* diagrams */
#write .md-focus .md-diagram-panel { border: 1px solid #DDD; margin-left: -1px; width: calc(100% + 2px); }
#write .md-focus.md-fences-with-lineno .md-diagram-panel { margin-left: auto; }
.md-diagram-panel-error { color: #C8514E; }

.active-tab-files #info-panel-tab-file,
.active-tab-files #info-panel-tab-file:hover,
.active-tab-outline #info-panel-tab-outline,
.active-tab-outline #info-panel-tab-outline:hover { color: #0F172A; }

.sidebar-footer-item:hover,
.footer-item:hover { background: inherit; color: #0F172A; }
.ty-side-sort-btn.active,
.ty-side-sort-btn:hover,
.selected-folder-menu-item a:after { color: #0F172A; }

#sidebar-files-menu { border: solid 1px; box-shadow: 4px 4px 20px rgba(0, 0, 0, 0.08); background-color: var(--bg-color); }
.file-list-item { border-bottom: none; }
.file-list-item-summary { opacity: 1; }
.file-list-item.active:first-child { border-top: none; }
.file-node-background { height: 32px; }
.file-library-node.active > .file-node-content,
.file-list-item.active { color: var(--active-file-text-color); }
.file-library-node.active > .file-node-background { background-color: var(--active-file-bg-color); }
.file-list-item.active { background-color: var(--active-file-bg-color); }

#ty-tooltip { background-color: var(--code-bg-color); color: var(--active-file-text-color); }

.md-task-list-item > input { margin-left: -1.3em; margin-top: 0.3rem; -webkit-appearance: none; }
.md-mathjax-midline { background-color: #E8EDF3; border-bottom: none; }

footer.ty-footer { border-color: var(--border-color); }

.ty-preferences .btn-default { background: transparent; }
.ty-preferences .btn-default:hover { background: #E8EDF3; }
.ty-preferences select { border: 1px solid #989698; height: 21px; }
.ty-preferences .nav-group-item.active,
.export-item.active,
.export-items-list-control,
.export-detail { background: var(--item-hover-bg-color); }
.ty-preferences input[type='search'] { border-color: #CCD6E0; background: #FFFFFF; line-height: 22px; border-radius: 6px; color: #1F2937; }
.ty-preferences input[type='search']:focus { box-shadow: none; }

[data-is-directory='true'] .file-node-content { margin-bottom: 0; }
.file-node-title { line-height: 22px; }
.html-for-mac .file-node-open-state,
.html-for-mac .file-node-icon { line-height: 26px; }

::-webkit-scrollbar-thumb { background: rgba(0, 0, 0, 0.15); }
::-webkit-scrollbar-thumb:active { background: rgba(0, 0, 0, 0.25); }
#typora-sidebar:hover div.sidebar-content-content::-webkit-scrollbar-thumb:horizontal { background: rgba(0, 0, 0, 0.15); }
.nav-group-item:active { background-color: #E3E7ED !important; }

.md-search-hit { background: #FFF4B1; color: #0F172A; }
.md-search-hit * { color: #0F172A; }
#md-searchpanel input { color: #1F2937; }
.modal-backdrop.in { opacity: 1; backdrop-filter: blur(1px); }
.clear-btn-icon { top: 8px; }

/* try fix https://github.com/typora/typora-issues/issues/5253 */
.file-node-expanded > .file-node-children { display: grid; }

.md-alert-text-note { color: rgb(47, 129, 247); }
.md-alert-text-important { color: rgb(163, 113, 247); }
.md-alert-text-warning { color: rgb(210, 153, 34); }

/* Prefer JetBrains Mono for code blocks and source view */
.CodeMirror,
.CodeMirror pre,
.CodeMirror-code,
pre.md-fences code {
  font-family: 'JetBrains Mono', Monaco, Consolas, 'Andale Mono', 'DejaVu Sans Mono', monospace;
  font-variant-ligatures: contextual;
}
/* --- Additional optimizations: 链接状态 / Spinner / CodeMirror 颜色 / 表格条纹 / 激活文件强调 / 焦点环 --- */

/* 链接访问状态与可访问性焦点优化 */
a:visited { color: #5A86E0; }
a:active { color: #0D4ECD; }
a:focus { outline: none; box-shadow: 0 0 0 3px rgba(191, 216, 255, 0.85); border-radius: 2px; }

/* 搜索 spinner 在浅色背景上的可读性优化 */
.typora-search-spinner > div { background-color: var(--control-text-color); }

/* CodeMirror 语法高亮（护眼、优雅、简洁、不花哨） */
.cm-s-inner .cm-comment { color: var(--code-token-comment); }
.cm-s-inner .cm-keyword { color: var(--code-token-keyword); }
.cm-s-inner .cm-def { color: var(--code-token-function); }
.cm-s-inner .cm-variable { color: var(--code-token-variable); }
.cm-s-inner .cm-variable-2 { color: var(--code-token-variable); }
.cm-s-inner .cm-variable-3 { color: var(--code-token-variable); }
.cm-s-inner .cm-string { color: var(--code-token-string); }
.cm-s-inner .cm-number { color: var(--code-token-number); }
.cm-s-inner .cm-attribute { color: var(--code-token-attribute); }
.cm-s-inner .cm-atom { color: var(--code-token-number); }
.cm-s-inner .cm-tag { color: var(--code-token-tag); }
.cm-s-inner .cm-builtin { color: var(--code-token-builtin); }
.cm-s-inner .cm-property { color: var(--code-token-property); }
.cm-s-inner .cm-qualifier { color: var(--code-token-attribute); }
.cm-s-inner .cm-operator { color: var(--code-token-operator); }
.cm-s-inner .CodeMirror-selected { background: var(--select-text-bg-color) !important; }
.CodeMirror.cm-s-inner .CodeMirror-selected { background: var(--select-text-bg-color) !important; }

/* 当前行轻微背景（增强定位，低打扰） */
.CodeMirror-activeline-background { background: #EEF2F7 !important; }

/* 表格轻度条纹与 hover，高可读不刺眼 */
table tbody tr:nth-child(2n) { background-color: #F9FBFD; }
table tbody tr:hover { background-color: var(--item-hover-bg-color); }

/* 激活文件左侧强调线（不改变布局） */
.file-library-node.active > .file-node-background,
.file-list-item.active { box-shadow: inset 2px 0 0 var(--active-file-border-color); }

/* 按钮焦点态（键盘导航友好） */
.btn:focus { outline: none; box-shadow: 0 0 0 3px rgba(191, 216, 255, 0.85); }

/* highlight.js 语法高亮（提升对比但保持低饱和护眼） */
pre.md-fences code.hljs { color: var(--text-color); background: var(--code-bg-color) !important; }
.hljs-comment, .hljs-quote { color: var(--code-token-comment); }
.hljs-keyword, .hljs-selector-tag, .hljs-type, .hljs-title, .hljs-section, .hljs-doctag { color: var(--code-token-keyword); }
.hljs-string, .hljs-meta .hljs-string, .hljs-template-tag { color: var(--code-token-string); }
.hljs-number, .hljs-literal { color: var(--code-token-number); }
.hljs-attribute, .hljs-attr { color: var(--code-token-attribute); }
.hljs-builtin-name, .hljs-built_in { color: var(--code-token-builtin); }
.hljs-function .hljs-title, .hljs-title.class_, .hljs-title.function_ { color: var(--code-token-function); }
.hljs-name, .hljs-tag { color: var(--code-token-tag); }
.hljs-variable, .hljs-params { color: var(--code-token-variable); }
.hljs-property { color: var(--code-token-property); }
.hljs-operator, .hljs-punctuation { color: var(--code-token-operator); }
.hljs-symbol { color: var(--code-token-builtin); }
.hljs-meta { color: var(--code-token-comment); }
.hljs-emphasis { font-style: italic; }
.hljs-strong { font-weight: 600; }

/* diff 增删，提升可读性而不刺眼 */
.hljs-addition { background: #E6F5EA; color: #225A2F; }
.hljs-deletion { background: #FBEAEA; color: #A83A2D; }